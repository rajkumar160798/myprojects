<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">
<head>
    <title>File Upload & BigQuery Table Creation</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <!-- Favicon -->
    <link rel="icon" type="image/vnd.microsoft.icon" href="https://www.aetna.com/content/dam/aetna/asset-libraries/logos/favicon-violet-heart-32x32.png">
   
   <style>
       /* General Styling */
       body {
           margin: 0;
           font-family: Arial, sans-serif;
           background: linear-gradient(135deg, #f8f9fa, #d1c4e9);
       }

       /* Content Section */
       .upload-container, .table-container {
           background-color: #f4f3f8;
           padding: 2rem;
           border-radius: 10px;
           max-width: 800px;
           margin: 50px auto;
           box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
           text-align: center;
       }

       .upload-container h2, .table-container h2 {
           color: #7d3f98;
       }

       /* Drag and Drop */
       .drop-zone {
           border: 2px dashed #7d3f98;
           border-radius: 10px;
           padding: 2rem;
           color: #7d3f98;
           cursor: pointer;
           background-color: #ffffff;
           margin-bottom: 1rem;
       }

       .drop-zone:hover {
           background-color: #f8e1ff;
       }

       .btn-upload {
           background-color: #7d3f98;
           color: white;
           padding: 0.5rem 1.5rem;
           border: none;
           border-radius: 5px;
           font-size: 1rem;
           margin-top: 1rem;
           cursor: pointer;
       }

       .btn-upload:hover {
           background-color: #6b2d87;
       }

       .success-message {
           color: green;
           font-size: 1rem;
           margin-top: 1rem;
           display: none;
       }

       .file-selected {
           color: #7d3f98;
           font-size: 1rem;
           margin-top: 10px;
           display: block;
       }

       .hidden { display: none; }

       footer {
           background-color: #4d0f68ea;
           color: white;
           text-align: center;
           padding: 1rem;
           position: absolute;
           bottom: 0;
           width: 100%;
           font-size: 0.9rem;
       }
   </style>
</head>

<body>
<!-- Main Content -->
   <div class="upload-container">
       <h2>Upload Files to GCS Bucket</h2>
       <p>Drag & Drop your file here or click to upload into the GCS bucket.</p>
       
       <!-- File upload form with drag and drop -->
       <form method="POST" enctype="multipart/form-data" action="/" id="uploadForm">
           <div class="drop-zone" id="dropZone">
               <p id="dropText">Drag & Drop File Here or Click to Upload</p>
               <input type="file" id="file" name="file" style="display: none;">
               <span id="fileName" class="file-selected hidden"></span>
           </div>
           <button type="submit" class="btn-upload">Upload</button>
       </form>
       <div id="successMessage" class="success-message">Upload Successful!</div>
   </div>

   <!-- Create/Replace BigQuery Table -->
   <div class="table-container">
       <h2>Create/Replace BigQuery Table</h2>
       <form th:action="@{/create-table}" method="post">
           <label for="dataset" class="form-label">Dataset Name</label>
           <input type="text" id="dataset" name="dataset" placeholder="Dataset Name" class="form-control mb-2" required>
           <label for="table" class="form-label">Table Name</label>
           <input type="text" id="table" name="table" placeholder="Table Name" class="form-control mb-2" required>
           <button type="submit" class="btn btn-success">Create Table</button>
       </form>
       <div th:if="${message}" class="alert alert-info mt-4" th:text="${message}"></div>
   </div>

   <!-- Footer Section -->
   <footer>
       <p>&copy; 2024</p>
   </footer>

<!-- JavaScript -->
   <script>
       // Drag and Drop functionality
       const dropZone = document.getElementById('dropZone');
       const fileInput = document.getElementById('file');
       const fileNameDisplay = document.getElementById('fileName');
       const dropText = document.getElementById('dropText');

       dropZone.addEventListener('click', () => fileInput.click());
       dropZone.addEventListener('dragover', (e) => {
           e.preventDefault();
           dropZone.style.backgroundColor = '#f8e1ff';
       });
       dropZone.addEventListener('dragleave', () => {
           dropZone.style.backgroundColor = '#ffffff';
       });
       dropZone.addEventListener('drop', (e) => {
           e.preventDefault();
           fileInput.files = e.dataTransfer.files;
           displayFileName(fileInput.files[0]?.name);
       });

       fileInput.addEventListener('change', () => {
           displayFileName(fileInput.files[0]?.name);
       });

       function displayFileName(fileName) {
           if (fileName) {
               fileNameDisplay.textContent = fileName;
               fileNameDisplay.classList.remove('hidden');
               dropText.classList.add('hidden');
               dropZone.style.border = '2px solid #7d3f98';
           }
       }

       // Show success message after upload
       document.getElementById('uploadForm').addEventListener('submit', function (e) {
           setTimeout(() => {
               document.getElementById('successMessage').style.display = 'block';
           }, 1000);
       });
   </script>
</body>
</html>
